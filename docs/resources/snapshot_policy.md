---
page_title: "thalassa_snapshot_policy Resource - terraform-provider-thalassa"
subcategory: "Storage"
description: |-
  Provides a Thalassa Cloud Snapshot Policy resource. This can be used to create, manage, and delete snapshot policies that automatically create snapshots of volumes based on a schedule.
---

# thalassa_snapshot_policy (Resource)

Provides a Thalassa Cloud Snapshot Policy resource. This can be used to create, manage, and delete snapshot policies that automatically create snapshots of volumes based on a schedule.

## Example Usage

```terraform
# Create a block volume that will be selected by the snapshot policy
resource "thalassa_block_volume" "example" {
  name        = "example-block-volume"
  description = "Example block volume for snapshot policy"
  region      = "nl-01"
  volume_type = "Block"
  size_gb     = 50

  # Labels to match the snapshot policy selector
  labels = {
    backup     = "enabled"
    environment = "production"
    service     = "database"
  }
}

# Example 1: Snapshot policy using label selector
resource "thalassa_snapshot_policy" "selector_example" {
  name        = "example-snapshot-policy-selector"
  description = "Example snapshot policy using label selector"
  region      = "nl-01"

  # Schedule: Daily at 2 AM UTC
  schedule = "0 2 * * *"
  timezone = "UTC"

  # TTL: Keep snapshots for 30 days
  ttl = "30d"

  # Optional: Keep maximum of 10 snapshots
  keep_count = 10

  # Enable the policy
  enabled = true

  # Target volumes using label selector
  target {
    type = "selector"
    selector = {
      backup      = "enabled"
      environment = "production"
    }
  }
}

# # Example 2: Snapshot policy targeting specific volumes
resource "thalassa_snapshot_policy" "explicit_example" {
  name        = "example-snapshot-policy-explicit"
  description = "Example snapshot policy targeting specific volumes"
  region      = "nl-01"

  # Schedule: Every 6 hours
  schedule = "0 */6 * * *"
  timezone = "UTC"

  # TTL: Keep snapshots for 7 days
  ttl = "7d"

  # Enable the policy
  enabled = true

  # Target specific volumes by their identities
  target {
    type              = "explicit"
    volume_identities = [thalassa_block_volume.example.id]
  }

  labels = {
    backup-type = "frequent"
  }
}

# Output the snapshot policy details
output "snapshot_policy_selector_id" {
  value = thalassa_snapshot_policy.selector_example.id
}

output "snapshot_policy_selector_name" {
  value = thalassa_snapshot_policy.selector_example.name
}

output "snapshot_policy_selector_next_snapshot_at" {
  value = thalassa_snapshot_policy.selector_example.next_snapshot_at
}

output "snapshot_policy_explicit_id" {
  value = thalassa_snapshot_policy.explicit_example.id
}
```
<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the snapshot policy
- `region` (String) Region of the snapshot policy
- `schedule` (String) Cron schedule for the snapshot policy (e.g., '0 2 * * *' for daily at 2 AM)
- `target` (Block List, Min: 1, Max: 1) Target configuration for the snapshot policy (see [below for nested schema](#nestedblock--target))
- `timezone` (String) Timezone for the snapshot policy schedule (e.g., 'UTC', 'America/New_York')
- `ttl` (String) Time to live for snapshots created by this policy. Supports formats like '168h' (hours), '7d' (days), '1w' (weeks). Examples: '24h', '7d', '30d'

### Optional

- `annotations` (Map of String) Annotations for the snapshot policy
- `description` (String) A human readable description about the snapshot policy
- `enabled` (Boolean) Whether the snapshot policy is enabled
- `keep_count` (Number) Maximum number of snapshots to retain. When this limit is reached, the oldest snapshots will be deleted.
- `labels` (Map of String) Labels for the snapshot policy
- `organisation_id` (String) Reference to the Organisation of the Snapshot Policy. If not provided, the organisation of the (Terraform) provider will be used.

### Read-Only

- `id` (String) The ID of this resource.
- `last_snapshot_at` (String) When the last snapshot was created
- `next_snapshot_at` (String) When the next snapshot will be created
- `slug` (String)

<a id="nestedblock--target"></a>
### Nested Schema for `target`

Required:

- `type` (String) Type of target: 'selector' to target volumes based on labels, or 'explicit' to target specific volumes

Optional:

- `selector` (Map of String) Label selector for volumes (required when type is 'selector')
- `volume_identities` (List of String) List of volume identities (required when type is 'explicit')



